# 关于压力测试

## 当前状况

系统上线前后，主导过几次压力测试，基于`LoadRunner`，测试脚本是用c写的，实现各种自定义协议的封装，各种`sessionid`数据准备，用户基础数据准备。

总的来说，体验并不好，有几个问题比较突出：

- 需要熟练掌握C语言，才能胜任定制各种业务场景下的测试脚本。
- 由于需要在云上启动压力机，为了压缩测试成本，每天都释放压力机实例，因此每天都需要手动购买、配置压力机。这些操作占据了很多工作时间，显得相当低效，没有生产力。
- 很难实现全流程自动化测试，需要手工操作的环节太多。
- `LoadRunner`功能强大，对于我们来说，有很多用不到的功能，所以看起来`LoadRunner`显得臃肿庞大。

##  替代方案

近期无意间发现了`Locust`这个项目，这是一个使用Python实现的开源性能测试工具，它支持master-slave工作模式，随着节点的扩张，能支持非常大的并发压力请求。

Locust能输出对指标包括：并发数、RPS、响应时间、异常率。

压力脚本由用户自定义开发，因此可以支持`tcp\udp\http\grpc`等等协议。

阿里的`myzhan`不满意Python的并发性能，用Go重写了Locust的Slave端实现。

也就是说，我可以用Go去模拟构建任何业务场景下的客户端代码，然后就可以开展测试工作。

而且用脚本就可以启动压力测试，不用在`UI`上点来点去，后期如果能在测试结果汇总这个环节也用脚本实现，那么这就是一套完整的自动化测试解决方案率。

## 参考资料

- http://debugtalk.com/post/head-first-locust-user-guide/
- https://github.com/myzhan/boomer